function esInitGl(b){var a=document.getElementById(b);var d=null;try{d=a.getContext("webgl")}catch(c){}if(d==null){try{d=a.getContext("experimental-webgl")}catch(c){}}return d}function esInitSw(b){var a=document.getElementById(b);return a.getContext("2d")}function esNextFrame(b){var c=Date.now();function a(){var d=Date.now();if(!b((d-c)*0.001)){window.requestAnimationFrame(a)}c=d}window.requestAnimationFrame(a)}var ES_VERTEX=1;var ES_FRAGMENT=2;function esProgram(a){this.gl=a;this.program=a.createProgram()}function compileShader(d,c,a){if(a==ES_VERTEX){a=d.VERTEX_SHADER}else{a=d.FRAGMENT_SHADER}var b=d.createShader(a);d.shaderSource(b,c);d.compileShader(b);if(!d.getShaderParameter(b,d.COMPILE_STATUS)){alert(d.getShaderInfoLog(b))}return b}esProgram.prototype.addShaderId=function(a,b){var c=document.getElementById(a).text;this.gl.attachShader(this.program,compileShader(this.gl,c,b))};esProgram.prototype.getUniform=function(a){return this.gl.getUniformLocation(this.program,a)};esProgram.prototype.link=function(){this.gl.linkProgram(this.program)};esProgram.prototype.use=function(){this.gl.useProgram(this.program)};var ES_LOAD_IMAGE=1;var ES_LOAD_AUDIO=2;function esLoad(){this.list=[]}esLoad.prototype.loadImage=function(a){var b=new Image();this.list.push([b,a,ES_LOAD_IMAGE]);return b};esLoad.prototype.loadAudio=function(a){var b=new Audio();this.list.push([b,a,ES_LOAD_AUDIO]);return b};esLoad.prototype.download=function(h){var g=this.list.length;for(var b=0;b<this.list.length;b++){var e=this.list[b];var f=e[0];var a=e[1];var c=e[2];var d=(function(j,i){return function(){g--;if(g==0){h()}}})(f,a);switch(c){default:case ES_LOAD_IMAGE:f.onload=d;f.src=a;break;case ES_LOAD_AUDIO:f.addEventListener("canplaythrough",d,false);f.src=a;break}}};function esFullFrame(b,d){var a=document.getElementById(b);a.style="padding: 0px; margin: 0px; position: absolute; left: 0px; top: 0px;";var c=function(){var e=window.innerWidth;var f=window.innerHeight;a.width=e;a.height=f;d(e,f)};window.addEventListener("resize",c,false);c()}function esVec3_create(){return new Float32Array([0,0,0])}function esVec3_parse(a,c,b){return new Float32Array([a,c,b])}function esVec3_add(b,a,c){b[0]=a[0]+c[0];b[1]=a[1]+c[1];b[2]=a[2]+c[2]}function esVec3_sub(b,a,c){b[0]=a[0]-c[0];b[1]=a[1]-c[1];b[2]=a[2]-c[2]}function esVec3_mulk(c,b,a){c[0]=a*b[0];c[1]=a*b[1];c[2]=a*b[2]}function esVec3_length(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}function esVec3_dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function esVec3_isZero(a){return a[0]==0&&a[1]==0&&a[2]==0}function esVec3_cross(b,a,c){b[0]=a[1]*c[2]-a[2]*c[1];b[1]=a[2]*c[0]-a[0]*c[2];b[2]=a[0]*c[1]-a[1]*c[0]}function esVec3_normalize(c,b){var a=1/esVec3_length(b);c[0]=a*b[0];c[1]=a*b[1];c[2]=a*b[2]}function esMat4_create(){return new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])}function esMat4_identity(a){a[0]=1;a[1]=a[2]=a[3]=0;a[5]=1;a[4]=a[6]=a[7]=0;a[10]=1;a[8]=a[9]=a[11]=0;a[15]=1;a[12]=a[13]=a[14]=0}function esMat4_mul(b,c,a){b[0]=a[0]*c[0]+a[1]*c[4]+a[2]*c[8]+a[3]*c[12];b[1]=a[0]*c[1]+a[1]*c[5]+a[2]*c[9]+a[3]*c[13];b[2]=a[0]*c[2]+a[1]*c[6]+a[2]*c[10]+a[3]*c[14];b[3]=a[0]*c[3]+a[1]*c[7]+a[2]*c[11]+a[3]*c[15];b[4]=a[4]*c[0]+a[5]*c[4]+a[6]*c[8]+a[7]*c[12];b[5]=a[4]*c[1]+a[5]*c[5]+a[6]*c[9]+a[7]*c[13];b[6]=a[4]*c[2]+a[5]*c[6]+a[6]*c[10]+a[7]*c[14];b[7]=a[4]*c[3]+a[5]*c[7]+a[6]*c[11]+a[7]*c[15];b[8]=a[8]*c[0]+a[9]*c[4]+a[10]*c[8]+a[11]*c[12];b[9]=a[8]*c[1]+a[9]*c[5]+a[10]*c[9]+a[11]*c[13];b[10]=a[8]*c[2]+a[9]*c[6]+a[10]*c[10]+a[11]*c[14];b[11]=a[8]*c[3]+a[9]*c[7]+a[10]*c[11]+a[11]*c[15];b[12]=a[12]*c[0]+a[13]*c[4]+a[14]*c[8]+a[15]*c[12];b[13]=a[12]*c[1]+a[13]*c[5]+a[14]*c[9]+a[15]*c[13];b[14]=a[12]*c[2]+a[13]*c[6]+a[14]*c[10]+a[15]*c[14];b[15]=a[12]*c[3]+a[13]*c[7]+a[14]*c[11]+a[15]*c[15]}function esMat4_ortho(b,c,e,a,d){b[1]=b[2]=b[3]=b[4]=b[6]=b[7]=b[8]=b[9]=0;b[0]=2/(a-c);b[5]=2/(d-e);b[10]=1;b[15]=1;b[12]=-(a+c)/(a-c);b[13]=-(d+e)/(d-e);b[14]=0}function esMat4_lookAt(e,c,b,a){var h=esVec3_create();esVec3_sub(h,b,c);esVec3_normalize(h,h);var g=esVec3_create();esVec3_cross(g,a,h);esVec3_normalize(g,g);var f=esMat4_create();esMat4_identity(f);f[0]=g[0];f[4]=g[1];f[8]=g[2];f[1]=a[0];f[5]=a[1];f[9]=a[2];f[2]=-h[0];f[6]=-h[1];f[10]=-h[2];var d=esMat4_create();esMat4_identity(d);d[12]=-c[0];d[13]=-c[1];d[14]=-c[2];esMat4_mul(e,f,d)}function esMat4_perspective(c,d,g,f,e){var j=f*Math.tan(d*0.5);var b=-j;var i=j;var a=-j/g;var h=j/g;c[0]=2*f/(i-b);c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*f/(h-a);c[6]=0;c[7]=0;c[8]=(i+b)/(i-b);c[9]=(h+a)/(h-a);c[10]=-(e+f)/(e-f);c[11]=-1;c[12]=0;c[13]=0;c[14]=-(2*e*f)/(e-f);c[15]=0}function esMat4_camera(b,c,h,g,e,f,a,d){var j=esMat4_create();esMat4_perspective(j,c,h,g,e);var i=esMat4_create();esMat4_lookAt(i,f,a,d);esMat4_mul(b,j,i)};